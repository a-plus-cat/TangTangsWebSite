extends layout

block main
  .regBackPic
    - const url = `?_csrf=${csrfToken}`
    form.d-flex.flex-column.mt-5.mx-5(
      name="userData"
      action=url
      method="post"
      enctype="multipart/form-data" 
      id="userData"
    )
      //- input(type='hidden' name='_csrf' value=`${csrfToken}`)
      fieldset.mb-1
        legend#iconTitle ğŸ—‚  è²“å“¡é ­åƒ
        .profilePic#picBlock.mt-5
          label.imgUpload#picLabel(for="userIcon" title="é»æ“Šä¸Šå‚³é ­åƒ")
          input#userIcon(
            type="file" 
            name="userIcon"
            accept="image/*" 
            onchange="readURL(this)"
            required
          )
      fieldset.mb-3
        legend ğŸ—‚ è²“å“¡è³‡æ–™
        .input-group.mb-2
          .input-group-prepend
            label.input-group-text.fieldName(for="name") è²“å“¡ç¨±å‘¼
          input.form-control#name(
            type="text" 
            name="name" 
            pattern="^[a-z A-Z 0-9]{5,10}"
            data-toggle="tooltip"
            title="è«‹å¡«å…¥5~10ä½è‹±æ–‡/æ•¸å­—çµ„åˆ"
            value=(member===undefined ? '' : member.name) 
            onfocus="this.value=''"
            required
          )
          span
        .input-group.mb-2
          .input-group-prepend
            label.input-group-text.fieldName(for="email") è²“å“¡ä¿¡ç®±
          input.form-control#email(
            type="email"
            name="email"
            data-toggle="tooltip"
            title="è«‹å¡«å…¥å¯ä½¿ç”¨ä¿¡ç®±ä½å€"
            value=(member===undefined ? '' : member.email)
            onfocus="this.value=''"
            required
          )
          span
        .input-group.mb-2
          .input-group-prepend
            label.input-group-text.fieldName(for="pwd") ç™»å…¥å¯†ç¢¼
          input.form-control#pwd(
            type="password" 
            name="pwd" 
            pattern="[a-z A-Z 0-9]{8,30}" 
            data-toggle="tooltip"
            title="è«‹å¡«å…¥8~30ä½è‹±æ–‡/æ•¸å­—çµ„åˆ"
            value=(member===undefined ? '' : member.pwd) 
            onfocus="this.value=''"
            required
          )
          span
        .input-group
          .input-group-prepend
            label.input-group-text.fieldName#confTitle(for="confirmPwd") å¯†ç¢¼ç¢ºèª  
          input.form-control#confirmPwd(
            type="password" 
            name="confirmPwd"
            data-toggle="tooltip"
            title="è«‹å¡«å…¥èˆ‡å¯†ç¢¼æ¬„ä½ç›¸åŒçš„å€¼"
            value=(member===undefined ? '' : member.confirmPwd)
            onfocus="this.value=''"
            required
          )
          span
      .mb-3.text-right    
        button#confirmBtn.btn.btn-danger.mb-1(type="button" onclick="stampAni()") å‚³é€è³‡æ–™
      img#stamp(src="/images/stamp.png" alt="ç¢ºèªå‚³é€è³‡æ–™")
  .modal.fade#notice
    .modal-dialog.modal-dialog-centered
      .modal-content
        .modal-header
          h3.modal-title Tang-Tang ã® å°æé†’
        .modal-body
          if errors
            each err in errors
              p #{err.msg}
          else 
            p(style="font-family: 'Microsoft JhengHei';") 
              | æ‰€æœ‰æ¬„ä½çš†ç‚º
              span.font-weight-bold.text-danger å¿…å¡«
              | å–”!!
        .modal-footer
          button.btn.btn-primary(type='button' data-dismiss='modal') Close
  script.
    $(document).ready(function(){
      $("#notice").modal("show");
      // inputæ¬„ä½maskè¨­ç½®(æ’é™¤è¦å‰‡å¤–å­—ç¬¦è¼¸å…¥)
      $('#name').inputmask({"mask": "*{5,10}"});
      $('#pwd').inputmask({"mask": "*{0,30}"});
      $('#confirmPwd').inputmask({"mask": "*{0,30}"});

      // é¡¯ç¤ºæ¬„ä½æç¤º
      $('#picLabel').tooltip({placement: "right", trigger: "hover"});
      $('[data-toggle="tooltip"]').tooltip({placement: "right", trigger: "focus"});

      $('#confirmPwd').prop('disabled', 'true');
      $('#confTitle').toggleClass('disableField');

      // inputç¬¬ä¸€æ¬¡è§¸ç™¼äº‹ä»¶æ™‚åŠ å…¥class
      $(':required').one('blur keydown', function() {
        $(this).addClass('modified');
      });
      $('#pwd').on('blur', unlockCPW);
      $("#confirmPwd").on('focus', setCpwPattern);
    });